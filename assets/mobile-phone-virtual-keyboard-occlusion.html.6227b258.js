import{i as p,o as e,c as o,a as n,k as a,F as c,g as l,b as t}from"./app.f538ca93.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const i={},r=l(`<h1 id="\u624B\u6A5F\u865B\u64EC\u9375\u76E4\u906E\u64CB\u554F\u984C-2025-\u65B0\u89E3\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u624B\u6A5F\u865B\u64EC\u9375\u76E4\u906E\u64CB\u554F\u984C-2025-\u65B0\u89E3\u6CD5" aria-hidden="true">#</a> \u624B\u6A5F\u865B\u64EC\u9375\u76E4\u906E\u64CB\u554F\u984C - 2025 \u65B0\u89E3\u6CD5</h1><h6 id="tags-web-ios-android-virtual-keyboard" tabindex="-1"><a class="header-anchor" href="#tags-web-ios-android-virtual-keyboard" aria-hidden="true">#</a> tags: <code>web</code>, <code>ios</code>, <code>android</code>, <code>virtual-keyboard</code></h6><h2 id="\u5FEB\u901F\u7D50\u8AD6" tabindex="-1"><a class="header-anchor" href="#\u5FEB\u901F\u7D50\u8AD6" aria-hidden="true">#</a> \u5FEB\u901F\u7D50\u8AD6</h2><p>\u7D42\u65BC\u4E0D\u7528\u5BEB\u4E00\u5806 JS \u8A08\u7B97\u9AD8\u5EA6\u4E86\uFF01\u73FE\u5728\u6709\u5169\u500B\u66F4\u7C21\u55AE\u7684\u65B9\u6CD5\uFF1A</p><h3 id="\u65B9\u6848\u4E00-\u4E00\u884C-html-\u641E\u5B9A-\u6700\u63A8\u85A6" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6848\u4E00-\u4E00\u884C-html-\u641E\u5B9A-\u6700\u63A8\u85A6" aria-hidden="true">#</a> \u65B9\u6848\u4E00\uFF1A\u4E00\u884C HTML \u641E\u5B9A\uFF08\u6700\u63A8\u85A6\uFF09</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u5B8C\u5168\u4E0D\u9700\u8981 JavaScript\uFF01</p><h3 id="\u65B9\u6848\u4E8C-virtualkeyboard-api" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6848\u4E8C-virtualkeyboard-api" aria-hidden="true">#</a> \u65B9\u6848\u4E8C\uFF1AVirtualKeyboard API</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span>overlaysContent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.footer</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr><h2 id="\u65B0\u65B9\u6848\u8A73\u89E3" tabindex="-1"><a class="header-anchor" href="#\u65B0\u65B9\u6848\u8A73\u89E3" aria-hidden="true">#</a> \u65B0\u65B9\u6848\u8A73\u89E3</h2><h3 id="\u65B9\u6848\u4E00-interactive-widget-meta-tag" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6848\u4E00-interactive-widget-meta-tag" aria-hidden="true">#</a> \u65B9\u6848\u4E00\uFF1A<code>interactive-widget</code> Meta Tag</h3><p>\u9019\u500B\u662F 2022 \u5E74\u624D\u52A0\u5165\u7684\u65B0\u5C6C\u6027\uFF0C\u5C08\u9580\u7528\u4F86\u63A7\u5236\u865B\u64EC\u9375\u76E4\u51FA\u73FE\u6642 viewport \u8981\u600E\u9EBC\u8ABF\u6574\u3002</p><h4 id="\u4E09\u7A2E\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u4E09\u7A2E\u6A21\u5F0F" aria-hidden="true">#</a> \u4E09\u7A2E\u6A21\u5F0F</h4><table><thead><tr><th>\u6A21\u5F0F</th><th>Layout Viewport</th><th>Visual Viewport</th><th>\u4EC0\u9EBC\u6642\u5019\u7528</th></tr></thead><tbody><tr><td><code>resizes-visual</code>\uFF08\u9810\u8A2D\uFF09</td><td>\u4E0D\u52D5</td><td>\u7E2E\u5C0F</td><td>\u4E00\u822C\u7DB2\u9801</td></tr><tr><td><code>resizes-content</code></td><td>\u7E2E\u5C0F</td><td>\u7E2E\u5C0F</td><td>\u804A\u5929\u5BA4\u3001\u8868\u55AE APP</td></tr><tr><td><code>overlays-content</code></td><td>\u4E0D\u52D5</td><td>\u4E0D\u52D5</td><td>\u904A\u6232\u3001canvas</td></tr></tbody></table><h4 id="\u770B\u5716\u66F4\u6E05\u695A" tabindex="-1"><a class="header-anchor" href="#\u770B\u5716\u66F4\u6E05\u695A" aria-hidden="true">#</a> \u770B\u5716\u66F4\u6E05\u695A</h4><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>resizes-visual\uFF08Chrome \u9810\u8A2D\uFF09:
\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510
\u2502   Header        \u2502 \u2190 \u56FA\u5B9A\u5728\u539F\u4F4D
\u2502   Content       \u2502
\u2502                 \u2502 \u2190 \u53EF\u80FD\u88AB\u9375\u76E4\u64CB\u4F4F
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502  \u{1F3B9} Keyboard    \u2502
\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518

resizes-content\uFF08\u63A8\u85A6\u7528\u9019\u500B\uFF09:
\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510
\u2502   Header        \u2502
\u2502   Content       \u2502 \u2190 viewport \u8DDF\u8457\u7E2E\u5C0F
\u2502                 \u2502   100svh \u4E5F\u6703\u81EA\u52D5\u8ABF\u6574
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502  \u{1F3B9} Keyboard    \u2502
\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="\u5BE6\u969B\u7BC4\u4F8B-\u804A\u5929\u5BA4" tabindex="-1"><a class="header-anchor" href="#\u5BE6\u969B\u7BC4\u4F8B-\u804A\u5929\u5BA4" aria-hidden="true">#</a> \u5BE6\u969B\u7BC4\u4F8B\uFF1A\u804A\u5929\u5BA4</h4><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100svh<span class="token punctuation">;</span>  <span class="token comment">/* \u642D\u914D svh \u66F4\u5B8C\u7F8E */</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token selector">header</span> <span class="token punctuation">{</span>
      <span class="token property">flex-shrink</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token selector">.messages</span> <span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>          <span class="token comment">/* \u81EA\u52D5\u586B\u6EFF\u5269\u9918\u7A7A\u9593 */</span>
      <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token comment">/* \u8A0A\u606F\u53EF\u4EE5\u6EFE\u52D5 */</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token selector">footer</span> <span class="token punctuation">{</span>
      <span class="token property">flex-shrink</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>Chat Room<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- \u5F88\u591A\u8A0A\u606F... --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\u8F38\u5165\u8A0A\u606F...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><strong>\u91CD\u9EDE\uFF1A</strong></p><ul><li>\u4E0D\u7528\u5BEB\u4EFB\u4F55 JavaScript</li><li>\u9375\u76E4\u5F48\u51FA\u6642 <code>100svh</code> \u6703\u81EA\u52D5\u8B8A\u5C0F</li><li>footer \u6C38\u9060\u5728\u756B\u9762\u6700\u4E0B\u9762\uFF0C\u4E0D\u6703\u88AB\u9375\u76E4\u84CB\u4F4F</li></ul><h4 id="\u700F\u89BD\u5668\u652F\u63F4" tabindex="-1"><a class="header-anchor" href="#\u700F\u89BD\u5668\u652F\u63F4" aria-hidden="true">#</a> \u700F\u89BD\u5668\u652F\u63F4</h4><ul><li>\u2705 Chrome Android 108+\uFF082022/10 \u958B\u59CB\uFF09</li><li>\u2705 Firefox 132+\uFF082024 \u958B\u59CB\uFF09</li><li>\u274C Safari / iOS Safari\uFF08\u9084\u4E0D\u652F\u63F4\uFF09</li></ul><hr><h3 id="\u65B9\u6848\u4E8C-virtualkeyboard-api-1" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6848\u4E8C-virtualkeyboard-api-1" aria-hidden="true">#</a> \u65B9\u6848\u4E8C\uFF1AVirtualKeyboard API</h3><p>\u9019\u500B API \u8B93\u4F60\u53EF\u4EE5\u7528 CSS \u8B8A\u6578\u4F86\u53D6\u5F97\u9375\u76E4\u7684\u9AD8\u5EA6\uFF0C\u800C\u4E0D\u7528\u81EA\u5DF1\u7B97\u3002</p><h4 id="\u57FA\u672C\u7528\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u7528\u6CD5" aria-hidden="true">#</a> \u57FA\u672C\u7528\u6CD5</h4><p><strong>Step 1: JavaScript \u555F\u7528 API</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;virtualKeyboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u544A\u8A34\u700F\u89BD\u5668\uFF1A\u6211\u8981\u81EA\u5DF1\u8655\u7406\u9375\u76E4</span>
  navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span>overlaysContent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  
  <span class="token comment">// \u53EF\u4EE5\u76E3\u807D\u9375\u76E4\u8B8A\u5316\uFF08\u53EF\u9078\uFF09</span>
  navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;geometrychange&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>boundingRect<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9375\u76E4\u9AD8\u5EA6:&#39;</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Step 2: CSS \u7528\u74B0\u5883\u8B8A\u6578</strong></p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* \u8B93 footer \u6C38\u9060\u5728\u9375\u76E4\u4E0A\u65B9 */</span>
<span class="token selector">.footer</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* \u6216\u662F\u7528 max() \u78BA\u4FDD\u6700\u5C0F\u9593\u8DDD */</span>
<span class="token selector">.button</span> <span class="token punctuation">{</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span>2rem<span class="token punctuation">,</span> 1rem + <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0rem<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_6-\u500B-css-\u74B0\u5883\u8B8A\u6578" tabindex="-1"><a class="header-anchor" href="#_6-\u500B-css-\u74B0\u5883\u8B8A\u6578" aria-hidden="true">#</a> 6 \u500B CSS \u74B0\u5883\u8B8A\u6578</h4><p>VirtualKeyboard API \u63D0\u4F9B\u4E86 6 \u500B CSS \u8B8A\u6578\uFF1A</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-top<span class="token punctuation">)</span>      <span class="token comment">/* \u9375\u76E4\u8DDD\u96E2\u4E0A\u65B9\u7684\u8DDD\u96E2 */</span>
<span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-right<span class="token punctuation">)</span>    <span class="token comment">/* \u9375\u76E4\u8DDD\u96E2\u53F3\u65B9\u7684\u8DDD\u96E2 */</span>
<span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-bottom<span class="token punctuation">)</span>   <span class="token comment">/* \u9375\u76E4\u8DDD\u96E2\u4E0B\u65B9\u7684\u8DDD\u96E2 */</span>
<span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-left<span class="token punctuation">)</span>     <span class="token comment">/* \u9375\u76E4\u8DDD\u96E2\u5DE6\u65B9\u7684\u8DDD\u96E2 */</span>
<span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-width<span class="token punctuation">)</span>    <span class="token comment">/* \u9375\u76E4\u5BEC\u5EA6 */</span>
<span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">)</span>   <span class="token comment">/* \u9375\u76E4\u9AD8\u5EA6\uFF08\u6700\u5E38\u7528\uFF09 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u9375\u76E4\u6C92\u51FA\u73FE\u6642\uFF0C\u6240\u6709\u503C\u90FD\u662F <code>0px</code>\u3002</p><h4 id="vue-\u5B8C\u6574\u7BC4\u4F8B" tabindex="-1"><a class="header-anchor" href="#vue-\u5B8C\u6574\u7BC4\u4F8B" aria-hidden="true">#</a> Vue \u5B8C\u6574\u7BC4\u4F8B</h4><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>chat-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u804A\u5929\u5BA4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messageBoardRef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- \u8A0A\u606F\u5167\u5BB9 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\u8F38\u5165\u8A0A\u606F...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onBeforeUnmount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> messageBoardRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleKeyboardChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>boundingRect<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;\u9375\u76E4\u9AD8\u5EA6:&#39;</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;virtualKeyboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span>overlaysContent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;geometrychange&#39;</span><span class="token punctuation">,</span> handleKeyboardChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;virtualKeyboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;geometrychange&#39;</span><span class="token punctuation">,</span> handleKeyboardChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.chat-container</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.messages</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.footer</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span>
  <span class="token comment">/* \u95DC\u9375\uFF1A\u7528 CSS \u8B8A\u6578\u81EA\u52D5\u907F\u958B\u9375\u76E4 */</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h4 id="\u700F\u89BD\u5668\u652F\u63F4-1" tabindex="-1"><a class="header-anchor" href="#\u700F\u89BD\u5668\u652F\u63F4-1" aria-hidden="true">#</a> \u700F\u89BD\u5668\u652F\u63F4</h4><ul><li>\u2705 Chrome 94+</li><li>\u2705 Edge 94+</li><li>\u2705 Chrome Android 94+</li><li>\u2705 Samsung Internet 17+</li><li>\u274C Safari\uFF08\u5B8C\u5168\u4E0D\u652F\u63F4\uFF09</li><li>\u274C Firefox\uFF08\u5B8C\u5168\u4E0D\u652F\u63F4\uFF09</li><li>\u274C iOS Safari\uFF08\u5B8C\u5168\u4E0D\u652F\u63F4\uFF09</li></ul><p><strong>\u6CE8\u610F\uFF1A</strong> \u76EE\u524D\u53EA\u6709 Chromium \u7CFB\u7684\u700F\u89BD\u5668\u652F\u63F4\u3002</p><hr><h2 id="\u8DDF\u820A\u65B9\u6848\u6BD4\u8F03" tabindex="-1"><a class="header-anchor" href="#\u8DDF\u820A\u65B9\u6848\u6BD4\u8F03" aria-hidden="true">#</a> \u8DDF\u820A\u65B9\u6848\u6BD4\u8F03</h2><h3 id="\u4E4B\u524D\u7684\u505A\u6CD5-visualviewport" tabindex="-1"><a class="header-anchor" href="#\u4E4B\u524D\u7684\u505A\u6CD5-visualviewport" aria-hidden="true">#</a> \u4E4B\u524D\u7684\u505A\u6CD5\uFF08<code>visualViewport</code>\uFF09</h3><p>\u9700\u8981\u5BEB\u4E00\u5806 JS \u4F86\u8A08\u7B97\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8981\u7B97\u53EF\u6EFE\u52D5\u7684\u9AD8\u5EA6</span>
<span class="token keyword">const</span> <span class="token function-variable function">calculateScrollableHeight</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> messageBoardWrapper <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;message-board-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> footerHeight <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;footer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>offsetHeight<span class="token punctuation">;</span>
  <span class="token keyword">const</span> scrollableHeight <span class="token operator">=</span> messageBoardWrapper<span class="token punctuation">.</span>clientHeight <span class="token operator">-</span> footerHeight<span class="token punctuation">;</span>
  scrollableHeightValue<span class="token punctuation">.</span>value <span class="token operator">=</span> scrollableHeight <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u9084\u8981\u8655\u7406 header \u7684 fixed</span>
<span class="token keyword">const</span> <span class="token function-variable function">calculateMobileHeightAndFixedHeader</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> height<span class="token punctuation">,</span> offsetTop <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token keyword">const</span> header <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;imHeader&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>offsetTop <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    header<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">&#39;fixed&#39;</span><span class="token punctuation">;</span>
    header<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>offsetTop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
    <span class="token comment">// ... \u4E00\u5806\u8A08\u7B97</span>
  <span class="token punctuation">}</span>
  <span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u8981\u76E3\u807D\u4E8B\u4EF6</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">calculateScrollableHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> calculateScrollableHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkIsIOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">checkIsAndroid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>visualViewport<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> calculateMobileHeightAndFixedHeader<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u8A18\u5F97\u53D6\u6D88\u76E3\u807D</span>
<span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>\u7136\u5F8C HTML \u9084\u8981\u52D5\u614B\u7D81\u5B9A\u9AD8\u5EA6\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> 
  <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{
    height: scrollableHeightValue + <span class="token punctuation">&#39;</span>px<span class="token punctuation">&#39;</span>,
    maxHeight: scrollableHeightValue + <span class="token punctuation">&#39;</span>px<span class="token punctuation">&#39;</span>,
  }<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="\u65B0\u65B9\u6848-interactive-widget" tabindex="-1"><a class="header-anchor" href="#\u65B0\u65B9\u6848-interactive-widget" aria-hidden="true">#</a> \u65B0\u65B9\u6848\uFF1A<code>interactive-widget</code></h3><p>\u53EA\u8981\u4E00\u884C\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u7136\u5F8C\u7528 Flexbox\uFF1A</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100svh<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.messages</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>\u4E0D\u7528\u5BEB\u4EFB\u4F55 JavaScript\uFF01</strong></p><h3 id="\u5DEE\u7570\u5C0D\u6BD4\u8868" tabindex="-1"><a class="header-anchor" href="#\u5DEE\u7570\u5C0D\u6BD4\u8868" aria-hidden="true">#</a> \u5DEE\u7570\u5C0D\u6BD4\u8868</h3><table><thead><tr><th>\u9805\u76EE</th><th>\u820A\u65B9\u6848</th><th>\u65B0\u65B9\u6848\u4E00</th><th>\u65B0\u65B9\u6848\u4E8C</th></tr></thead><tbody><tr><td><strong>JavaScript</strong></td><td>50+ \u884C</td><td>0 \u884C</td><td>~10 \u884C</td></tr><tr><td><strong>\u8907\u96DC\u5EA6</strong></td><td>\u5F88\u8907\u96DC</td><td>\u8D85\u7C21\u55AE</td><td>\u7C21\u55AE</td></tr><tr><td><strong>\u624B\u52D5\u8A08\u7B97\u9AD8\u5EA6</strong></td><td>\u9700\u8981</td><td>\u4E0D\u7528</td><td>\u4E0D\u7528</td></tr><tr><td><strong>\u76E3\u807D\u4E8B\u4EF6</strong></td><td>\u9700\u8981</td><td>\u4E0D\u7528</td><td>\u53EF\u9078</td></tr><tr><td><strong>\u88DD\u7F6E\u6AA2\u6E2C</strong></td><td>\u9700\u8981</td><td>\u4E0D\u7528</td><td>\u4E0D\u7528</td></tr><tr><td><strong>\u700F\u89BD\u5668\u652F\u63F4</strong></td><td>\u5168\u90E8</td><td>Chrome/Firefox</td><td>Chrome \u7CFB</td></tr></tbody></table><hr><h2 id="\u600E\u9EBC\u9078\u64C7" tabindex="-1"><a class="header-anchor" href="#\u600E\u9EBC\u9078\u64C7" aria-hidden="true">#</a> \u600E\u9EBC\u9078\u64C7\uFF1F</h2><h3 id="\u60C5\u6CC1\u4E00-\u53EA\u9700\u8981\u652F\u63F4-android" tabindex="-1"><a class="header-anchor" href="#\u60C5\u6CC1\u4E00-\u53EA\u9700\u8981\u652F\u63F4-android" aria-hidden="true">#</a> \u60C5\u6CC1\u4E00\uFF1A\u53EA\u9700\u8981\u652F\u63F4 Android</h3><p><strong>\u7528 <code>interactive-widget=resizes-content</code></strong></p><p>\u6700\u7C21\u55AE\uFF0C\u4E00\u884C HTML \u89E3\u6C7A\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u60C5\u6CC1\u4E8C-\u9700\u8981\u66F4\u7CBE\u7D30\u7684\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u60C5\u6CC1\u4E8C-\u9700\u8981\u66F4\u7CBE\u7D30\u7684\u63A7\u5236" aria-hidden="true">#</a> \u60C5\u6CC1\u4E8C\uFF1A\u9700\u8981\u66F4\u7CBE\u7D30\u7684\u63A7\u5236</h3><p><strong>\u7528 VirtualKeyboard API</strong></p><p>\u53EF\u4EE5\u62FF\u5230\u9375\u76E4\u78BA\u5207\u7684\u9AD8\u5EA6\u3001\u76E3\u807D\u8B8A\u5316\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span>overlaysContent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;geometrychange&#39;</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="\u60C5\u6CC1\u4E09-\u9700\u8981\u652F\u63F4-ios" tabindex="-1"><a class="header-anchor" href="#\u60C5\u6CC1\u4E09-\u9700\u8981\u652F\u63F4-ios" aria-hidden="true">#</a> \u60C5\u6CC1\u4E09\uFF1A\u9700\u8981\u652F\u63F4 iOS</h3><p><strong>\u9084\u662F\u5F97\u7528 <code>visualViewport</code> \u{1F622}</strong></p><p>\u56E0\u70BA Safari \u5169\u500B\u65B0\u65B9\u6CD5\u90FD\u4E0D\u652F\u63F4\uFF0C\u6240\u4EE5\u8981\u9019\u6A23\u5BEB\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u512A\u5148\u7528\u65B0 API</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;virtualKeyboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span>overlaysContent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    navigator<span class="token punctuation">.</span>virtualKeyboard<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;geometrychange&#39;</span><span class="token punctuation">,</span> handleChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> 
  <span class="token comment">// iOS \u7684 fallback</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>visualViewport<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>visualViewport<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> calculateHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><hr><h2 id="\u5F9E\u820A\u65B9\u6848\u9077\u79FB" tabindex="-1"><a class="header-anchor" href="#\u5F9E\u820A\u65B9\u6848\u9077\u79FB" aria-hidden="true">#</a> \u5F9E\u820A\u65B9\u6848\u9077\u79FB</h2><p>\u5982\u679C\u60F3\u628A\u73FE\u6709\u7684 <code>visualViewport</code> \u65B9\u6848\u6539\u6210\u65B0\u7684\uFF0C\u53EF\u4EE5\u9019\u6A23\u505A\uFF1A</p><h3 id="step-1-\u52A0-meta-tag" tabindex="-1"><a class="header-anchor" href="#step-1-\u52A0-meta-tag" aria-hidden="true">#</a> Step 1: \u52A0 Meta Tag</h3><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="step-2-\u6539-css-\u7528-flexbox" tabindex="-1"><a class="header-anchor" href="#step-2-\u6539-css-\u7528-flexbox" aria-hidden="true">#</a> Step 2: \u6539 CSS \u7528 Flexbox</h3><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* \u4E4B\u524D\uFF1A\u52D5\u614B\u7B97\u9AD8\u5EA6 */</span>
&lt;<span class="token property">div</span> <span class="token punctuation">:</span>style=<span class="token string">&quot;{ height: scrollableHeightValue + &#39;px&#39; }&quot;</span>&gt;

<span class="token comment">/* \u73FE\u5728\uFF1A\u7528 flex */</span>
<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100svh<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.messages</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="step-3-\u522A\u6389-js-android-\u7528\u6236" tabindex="-1"><a class="header-anchor" href="#step-3-\u522A\u6389-js-android-\u7528\u6236" aria-hidden="true">#</a> Step 3: \u522A\u6389 JS\uFF08Android \u7528\u6236\uFF09</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u9019\u4E9B\u90FD\u53EF\u4EE5\u522A\u4E86</span>
<span class="token comment">// \u274C calculateScrollableHeight()</span>
<span class="token comment">// \u274C calculateMobileHeightAndFixedHeader()  </span>
<span class="token comment">// \u274C window.addEventListener(&#39;resize&#39;, ...)</span>
<span class="token comment">// \u274C visualViewport.addEventListener(&#39;resize&#39;, ...)</span>
<span class="token comment">// \u274C scrollableHeightValue \u8B8A\u6578</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="step-4-\u4FDD\u7559-ios-\u7684\u908F\u8F2F-\u53EF\u9078" tabindex="-1"><a class="header-anchor" href="#step-4-\u4FDD\u7559-ios-\u7684\u908F\u8F2F-\u53EF\u9078" aria-hidden="true">#</a> Step 4: \u4FDD\u7559 iOS \u7684\u908F\u8F2F\uFF08\u53EF\u9078\uFF09</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u53EA\u7559 iOS \u7684 fallback</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkIsIOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token string">&#39;virtualKeyboard&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>visualViewport<span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> calculateHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr><h2 id="\u5C0F\u6280\u5DE7" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u6280\u5DE7" aria-hidden="true">#</a> \u5C0F\u6280\u5DE7</h2><h3 id="_1-\u642D\u914D\u65B0\u7684-viewport-\u55AE\u4F4D" tabindex="-1"><a class="header-anchor" href="#_1-\u642D\u914D\u65B0\u7684-viewport-\u55AE\u4F4D" aria-hidden="true">#</a> 1. \u642D\u914D\u65B0\u7684 Viewport \u55AE\u4F4D</h3><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100svh<span class="token punctuation">;</span>  <span class="token comment">/* \u9375\u76E4\u51FA\u73FE\u6642\u6703\u81EA\u52D5\u8ABF\u6574 */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-\u7528-grid-\u9810\u7559\u9375\u76E4\u7A7A\u9593" tabindex="-1"><a class="header-anchor" href="#_2-\u7528-grid-\u9810\u7559\u9375\u76E4\u7A7A\u9593" aria-hidden="true">#</a> 2. \u7528 Grid \u9810\u7559\u9375\u76E4\u7A7A\u9593</h3><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span>
  <span class="token property">grid-template</span><span class="token punctuation">:</span>
    <span class="token string">&quot;header&quot;</span> auto
    <span class="token string">&quot;content&quot;</span> 1fr
    <span class="token string">&quot;footer&quot;</span> auto
    <span class="token string">&quot;keyboard&quot;</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0px<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* \u9375\u76E4\u5340\u57DF */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-\u6F38\u9032\u5F0F\u589E\u5F37" tabindex="-1"><a class="header-anchor" href="#_3-\u6F38\u9032\u5F0F\u589E\u5F37" aria-hidden="true">#</a> 3. \u6F38\u9032\u5F0F\u589E\u5F37</h3><p>\u5148\u7528\u65B0\u65B9\u6CD5\uFF0C\u4E0D\u652F\u63F4\u518D fallback\uFF1A</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.footer</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* \u652F\u63F4 VirtualKeyboard API \u6642 */</span>
<span class="token atrule"><span class="token rule">@supports</span> <span class="token punctuation">(</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">)</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.footer</span> <span class="token punctuation">{</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>keyboard-inset-height<span class="token punctuation">,</span> 0px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><hr><h2 id="\u6E2C\u8A66\u6E05\u55AE" tabindex="-1"><a class="header-anchor" href="#\u6E2C\u8A66\u6E05\u55AE" aria-hidden="true">#</a> \u6E2C\u8A66\u6E05\u55AE</h2><p>\u8A18\u5F97\u6E2C\u8A66\u9019\u4E9B\u60C5\u6CC1\uFF1A</p><ul><li>\u2705 Chrome Android\uFF08<code>interactive-widget</code>\uFF09</li><li>\u2705 Firefox Android\uFF08<code>interactive-widget</code>\uFF09</li><li>\u2705 iOS Safari\uFF08<code>visualViewport</code> fallback\uFF09</li><li>\u2705 \u6A6B\u5411 / \u76F4\u5411</li><li>\u2705 \u9375\u76E4\u5F48\u51FA / \u6536\u8D77</li><li>\u2705 \u5916\u63A5\u9375\u76E4</li></ul><hr><h2 id="\u7E3D\u7D50" tabindex="-1"><a class="header-anchor" href="#\u7E3D\u7D50" aria-hidden="true">#</a> \u7E3D\u7D50</h2><h3 id="_2025-\u5E74\u63A8\u85A6\u505A\u6CD5" tabindex="-1"><a class="header-anchor" href="#_2025-\u5E74\u63A8\u85A6\u505A\u6CD5" aria-hidden="true">#</a> 2025 \u5E74\u63A8\u85A6\u505A\u6CD5\uFF1A</h3><ol><li><p><strong>Android \u70BA\u4E3B\u7684 APP</strong>\uFF1A</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>interactive-widget=resizes-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u4E00\u884C\u641E\u5B9A\uFF0C\u4E0D\u7528\u5BEB JS\uFF01</p></li><li><p><strong>\u9700\u8981\u652F\u63F4 iOS</strong>\uFF1A</p><ul><li>\u7528 <code>interactive-widget</code> + <code>visualViewport</code> \u96D9\u8ECC\u5236</li><li>Android \u5403\u65B0\u65B9\u6CD5\uFF0CiOS \u5403\u820A\u65B9\u6CD5</li></ul></li><li><p><strong>\u9700\u8981\u7CBE\u7D30\u63A7\u5236</strong>\uFF1A</p><ul><li>\u7528 VirtualKeyboard API</li><li>\u53EF\u4EE5\u62FF\u5230\u9375\u76E4\u6E96\u78BA\u7684\u4F4D\u7F6E\u548C\u5927\u5C0F</li></ul></li></ol><p>\u5F9E\u4EE5\u524D\u8981\u5BEB 50+ \u884C JS\uFF0C\u5230\u73FE\u5728\u4E00\u884C HTML \u6216\u5E7E\u884C CSS \u5C31\u641E\u5B9A\uFF0C\u9019\u5C31\u662F Web \u6A19\u6E96\u9032\u6B65\u7684\u5730\u65B9 \u{1F389}</p><hr><h3 id="\u53C3\u8003" tabindex="-1"><a class="header-anchor" href="#\u53C3\u8003" aria-hidden="true">#</a> \u53C3\u8003</h3>`,101),k={href:"https://developer.mozilla.org/en-US/docs/Web/API/VirtualKeyboard_API",target:"_blank",rel:"noopener noreferrer"},d=t("VirtualKeyboard API - MDN"),b={href:"https://htmhell.dev/adventcalendar/2024/4/",target:"_blank",rel:"noopener noreferrer"},m=t("interactive-widget - HTMLHell"),h={href:"https://developer.chrome.com/blog/viewport-resize-behavior",target:"_blank",rel:"noopener noreferrer"},g=t("Chrome Viewport Resize Behavior"),v={href:"https://caniuse.com/mdn-api_navigator_virtualkeyboard",target:"_blank",rel:"noopener noreferrer"},f=t("Can I Use: VirtualKeyboard API");function y(x,w){const s=p("ExternalLinkIcon");return e(),o(c,null,[r,n("ul",null,[n("li",null,[n("a",k,[d,a(s)])]),n("li",null,[n("a",b,[m,a(s)])]),n("li",null,[n("a",h,[g,a(s)])]),n("li",null,[n("a",v,[f,a(s)])])])],64)}var _=u(i,[["render",y]]);export{_ as default};
